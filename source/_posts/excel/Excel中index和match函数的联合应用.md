---
title: Excel中index和match的应用
date: 2022-10-27 16:37:23
tags:
 - excel
 - index
 - match
categories:Excel
---

#### Excel中index函数和match函数的应用

  通过一项关联的数据， 从另外一个表中向当前表中获取数据，可以使用index函数和match函数联用来实现。

  index(要获取的数据所在的数据区域，row)

​    一句话就是在指定的列区域(一般是一列)按照行号进行索引，第一个参数就是指定的列区域，一般用$进行固定； 第二个参数是通过关联字段找到对应的行号。
  而index()中的row如何获取呢？可以通过match（）函数来返回。将当前表中的关联的数据项代入到match（） ，在目标表中对应数据区域中找到相同的数据，然后由match()返回对应的行数。
  注意三个要点：
  1、index()函数的第一个参数。index()函数的第一个参数是指定一个要获取的数据的区域（比如表格中的姓名列）。要获取的数据区域表示方法： Sheet2！$b$2:$b$200  ,是指从表二中的B列第二行到第200行的一个数据区域。

   2、match（参数1，参数2,参数3）。参数1是当前表中和目标表之间关联的数据项，比如两个表中都有身份证号且唯一，就可以通过身份证号作为关联数据项。简单的说，参数1就是当前表中的关联数据项，参数2是目标表格中的一个指定区域，用来和参数一进行关联的区域，比如身份证号区域。)
   参数2是目标表中要关联的数据所在的一个数据区域，比如身份证号所在的数据区域： Sheet2!$c$2:$c$200  。简言之，就是在目标表中指定的数据区域中查找身份证号(或任何关联数据)。
  参数3是指定match函数的查询方式，一般默认为0就可以。
3、关于数据格式问题。一般由应用程序从数据库中导出的数据包特定功能格式，在书写公式时可能会导致会出错，因此可以点击表格左上角的全选按钮，然后点击编辑|清除菜单下的[格式]菜单项，可以清除表格中特定的格式，这样在写公式时就不会因为格式问题而出错。


有了这三条，就可从数据库中导出表格，在任意两个可关联的表格之间获取数据。

* 注意事项：如果index（）公式失效，那么最大的可能就是关联的数据包含空格，选中整列数据，使用查找替换替换掉空格就好了。或者全选整个表格，选择清除格式(可能是从数据库中导出的数据里包含有特定格式符号)
   


 
